# 常用命令积累

## 一、查看网络状态

### ss

用于获取 socket 统计信息。

安装包：iproute

以下是 ss 常用参数的表格：

```bash
ss [ OPTIONS ] [ FILTER ]
参数	作用说明
-a,--all	显示所有连接（包括监听状态的套接字）
-t,--tcp	显示 TCP 连接
-u,--udp	显示 UDP 连接
-l,--listening	仅显示监听的套接字
-p,--processes	显示进程信息
-n,--numeric	不解析服务名，直接显示端口号
-r,--resolve	解析地址中的主机名
-s,--summary	显示套接字摘要统计信息
-i	显示内部信息，如 TCP 状态
-4,--ipv4	显示 IPv4 套接字
-6,--ipv6	显示 IPv6 套接字
-K	终止匹配的套接字
-A	显示指定的套接字类型，如 inet、unix、packet 等
#可以按照目标地址和端口进行过滤，例如：
# 匹配目标地址和端口
ss dst 192.168.1.5
ss dst 192.168.1.5:http
ss dst 192.168.1.5:443
# 匹配源地址和端口
ss src 192.168.1.10
ss src 192.168.1.10:ssh
ss src 192.168.1.10:22

#按照端口号大小进行过滤，例如：
#源端口号小于50
ss -tunl sport lt 50
#目标端口大于1024的连接
ss -ta dport gt 1024
#操作符：
<= le;>= ge;== eq;!= ne;> gt;< lt

#按照状态进行过滤
常见的状态有：established、syn-sent、syn-recv、fin-wait-1、fin-wait-2、time-wait、closed、close-wait、last-ack、listening和closing。
```

https://blog.csdn.net/qq_59334230/article/details/153781981?fromshare=blogdetail&sharetype=blogdetail&sharerId=153781981&sharerefer=PC&sharesource=m0_74140718&sharefrom=from_link



### netstat

用于查询和统计网络连接的状态和数据传输情况。

安装包：net-tools

```bash
netstat [选项] [参数]
参数	作用说明
#协议相关
-t, --tcp           显示TCP协议连接
-u, --udp           显示UDP协议连接
-w, --raw           显示RAW协议连接
-x, --unix          显示Unix域套接字连接
--inet              仅显示IPv4连接
--inet6             仅显示IPv6连接
-s, --statistics    显示每个协议的统计信息

#连接状态选项
-a, --all           显示所有连接和监听端口
-l, --listening     仅显示监听状态的套接字
-e, --extend        显示扩展信息，可与-a一起使用获得更详细信息
-o, --timers        显示计时器信息（TCP连接的计时器）
-n, --numeric       以数字形式显示地址和端口号（不进行DNS解析）

#路由表选项
-r, --route         显示内核路由表
-N, --netlink       显示路由表中的网络链接信息
-F, --fib           显示FIB（转发信息库）路由表
-C, --cache         显示路由缓存

#网络接口选项
-i, --interfaces    显示网络接口列表
-g, --groups        显示IPv4/IPv6多播组成员
-c, --continuous    持续显示，每秒刷新一次

#进程/用户相关
-p, --program       显示使用套接字的进程ID和进程名称
-v, --verbose       详细模式
-W, --wide          不截断IP地址（显示完整的IPv6地址）
-Z, --context       显示SELinux安全上下文

#其他
-h, --help          显示帮助信息
-V, --version       显示版本信息
-b, --bytes         以字节为单位显示接口统计（默认为KB）
-d, --details       显示额外详细信息
-A, --address-family=AF[,AF...] 指定地址族，如inet,inet6,unix
-c, --continuous 连续显示网络状态信息。按 Ctrl + C 结束。

## 常用组合
netstat -tulnp # 查看所有监听端口及其对应进程
netstat -ant # 以数字形式查看所有TCP连接
netstat -i # 查看网络接口统计
netstat -ape # 显示扩展信息和进程
```



### ip

用于管理与配置网络接口和路由表

安装包：iproute

```bash
ip [ OPTIONS ] OBJECT { COMMAND | help }
选项：（但是用的很少）
-V, -Version        显示iproute2版本信息
-h, -human, -human-readable
                    以人类可读格式显示统计信息（自动选择单位）
-b, -batch <FILENAME>
                    从文件中读取命令
-s, -stats, -statistics
                    显示更详细的统计信息，多次使用会显示更多信息
-f, -family <AF>   指定地址族（inet, inet6, bridge, dnet, ipx, etc）
-4                  等同于 -family inet
-6                  等同于 -family inet6
-B                  等同于 -family bridge
-D                  等同于 -family dnet
-I                  等同于 -family ipx
-M                  等同于 -family mpls
-0                  等同于 -family link
-o, -oneline        每行输出一条记录，适用于脚本处理
-t, -timestamp      在监控模式中显示时间戳
-tt, -tstamp        在监控模式中显示更精确的时间戳
-json               以JSON格式输出
-p, -pretty         以美观的格式输出JSON

常用对象：
address：管理IP地址
link：网络设备管理
route：路由表项管理
rule：路由策略数据库中的规则
neighbor：管理ARP或NDISC缓存项
tunnel：IP隧道管理
netns：网络命名空间管理
monitor：网络状态监控
```



### tcpdump

基于命令行的数据包捕获和分析工具，支持多种网络协议和数据包格式

```bash
#基本语法
tcpdump [options] [expression]
#捕获控制参数
-i:指定要监听的网卡
-c:指定要捕获的数据包数量，当数量收集满足时退出
-s:指定幺捕获的数据包的大小
-w:将捕获的数据报保存到文件中
#显示控制参数
-n:以数字形式显示地址，而不是尝试解析为主机名
-A:以ASCII的格式显示数据包内容
-v:输出稍微详细的信息
-VV:输出详细的报文信息
#过滤参数
host host:捕获特定主机的数据包
net network:捕获特定网络的数据包
port port:捕获特定端口的数据包
src source:捕获特定源地址的数据包
dst destination:捕获特定目的地址的数据包
mac地址： 指定mac地址进行抓包； src mac:源mac dst mac:目的mac
protocol:捕获特定协议的数据包
#读取和写入
-r <xxx.pcap>:从文件中读取数据
-w <xxx.pcap>:将捕获到的信息保存到文件中，且不分析和打印在屏幕中
#其他
-X:以十六进制和ASCII格式显示数据包内容
-t:在输出的每一行不打印时间戳
-tt:在每一行中数据非格式化的时间戳
-ttt:输出在本行和前面一行之间的时间差
-tttt:在每一行中输出data处理的默认格式的时间戳
-q:以安静的模式运行，减少输出信息
-d:将匹配信息包的代码以人类看得懂的汇编格式输出
-D:打印xi'tong中所有可以监控
```



### nslookup

nslookup 用于查询DNS的记录，查询域名解析是否正常，在网络故障时用来诊断网络问题

安装方法：yum -y install bind-utils

```bash
#nslookup命令格式
nslookup –option1 –option2 host-to-find dns-server
```

交互模式

1.直接查询域名（host [server]）：以默认的 上连DNS服务器进行域名查询

```bash
#案例
[root@localhost ~]# nslookup
> www.baidu.com
Server:         192.168.142.2 // 上连的DNS服务器
Address:        192.168.142.2#53 // 上连的DNS服务器的IP地址与端口号

Non-authoritative answer: // 非权威答案，即从上连DNS服务器的本地缓存中读取出的值，而非实际去查询到的值
www.baidu.com   canonical name = www.a.shifen.com. // 说明www.baidu.com有个别名叫www.a.shifen.com
Name:   www.a.shifen.com    // 域名www.a.shifen.com
Address: 220.181.38.149     // 对应的IP地址之一,对应的描述信息为“北京市 百度网讯科技”
Name:   www.a.shifen.com    // 域名www.a.shifen.com
Address: 220.181.38.150     // 对应的IP地址之二
```

2.server [domain]：先使用默认的 上连DNS服务器对domain的IP地址进行查询，然后将查询到的服务器作为新的上连DNS服务器。

lserver [domain]：取本地的第一台DNS服务器来查询domain的IP地址，并将之作为当前默认上连DNS服务器。（lserver中的首字母l就是local的意思）

3.set `<opts> [=<value>]`：设置指定选项

选项包括：

```bash
all：此关键字打印常用选项的当前值。同时也会显示当前默认服务器和主机的信息。
class=value：此关键字将查询类别更改为以下之一：
IN：互联网类别
CH：Chaos类别
HS：Hesiod类别
ANY：通配符
类别指定信息的协议组。默认值为IN；此关键字的缩写是cl。

nodebug：此关键字开启或关闭完整响应数据包以及搜索过程中的任何中间响应数据包的显示。默认值为nodebug；此关键字的缩写是[no]deb。

nod2：此关键字开启或关闭调试模式。启用后会显示更多关于nslookup执行过程的详细信息。默认值为nod2。

domain=name：此关键字将搜索列表设置为name。

nosearch：如果查询请求包含至少一个点，但末尾没有点，此关键字会将域搜索列表中的域名依次附加到请求中，直到收到有效响应。默认值为search（启用搜索）。

port=value：此关键字将默认的TCP/UDP域名服务器端口从默认的53端口更改为value。此关键字的缩写是po。

querytype=value | type=value：此关键字将信息查询的类型更改为value。默认类型为A，然后是AAAA；这些关键字的缩写分别是q和ty。
A：查看主机的IPv4地址
AAAA：查看主机的IPv6地址
ANY：查看关于主机域的所有信息
CNAME：查找与别名对应的正式名字
HINFO：查找主机的CPU与操作系统类型
MINFO：查找邮箱信息
MX：查找邮件交换信息
NS：查找主机域的域名服务器
PTR：查找与给定IP地址匹配的主机名
RP：查找域负责人记录
SOA：查找域内的SOA地址
UINFO：查找用户信息
请注意，一次只能指定一种查询类型。只有在使用默认行为且未指定替代类型时，才会同时查询A和AAAA记录。

norecurse：此关键字指示域名服务器在没有所需信息时不向其他服务器查询。默认值为recurse（递归查询）；此关键字的缩写是[no]rec。

ndots=number：此关键字设置域名称中禁用搜索功能所需的点数（标签分隔符）。绝对名称（以点结尾的名称）始终会停止搜索。

retry=number：此关键字将重试次数设置为number。

timeout=number：此关键字将等待回复的初始超时间隔更改为number秒。

novc：此关键字指示在向服务器发送请求时始终使用虚拟电路（TCP连接）。novc（不使用虚拟电路，即使用UDP）是默认值。

nofail：当域名服务器返回SERVFAIL错误或引用响应时，此关键字决定是尝试下一个域名服务器（nofail），还是终止查询（fail）。默认值为nofail。
```

4.exit：退出



非交互模式

1.查询域名对应的IP地址：nslookup www.example.com

2.查询MX记录：nslookup -query/type=MX example.com 

3.反向解析：nslookup 192.168.1.1 #解析192.168.1.1的主机名

4.指定DNS服务器查询 ：nslookup www.example.com 8.8.8.8



### dig



### telnet



### iotop



## 二、压力测试

### 系统压力测试

#### ab

```bash
ab全称为apache benchmark是apache自带的一个性能测试工具，位于apache安装目录下的bin目录下
ab的原理：ab命令会创建 多个并发 访问线程，模拟 多个访问者 同时对某一 URL地址 进行访问。
它的测试目标是基于URL的，因此，它既可以用来测试apache的负载压力，也可以测试nginx、lighthttp、tomcat、IIS等其它Web服务器的压力。
ab是一个命令行工具， ab命令对发出负载的计算机要求很低，它既不会占用很高CPU，也不会占用很多内存。但却会给目标服务器造成巨大的负载，其原理类似CC攻击。自己测试使用也需要注意，否则一次上太多的负载。可能造成目标服务器资源耗完，严重时甚至导致死机。
yum -y install httpd-tools
# 通过 ab -h 可以查看所有命令参数，下面常用的参数进行说明：
# -n和-t一次只能使用一个

-n requests     Number of requests to perform          //在测试会话中所执行的请求个数（请求总数）。默认时，仅执行一个请求
-c concurrency  Number of multiple requests to make    //一次产生的请求个数（并发数） 默认是一次一个
-t timelimit    Seconds to max. wait for responses     //测试所进行的最大秒数。其内部隐含值是-n 50000。它可以使对服务器的测试限制在一个固定的总时间以内。默认时，没有时间限制。
-p postfile     File containing data to POST           //包含了需要POST的数据的文件.
-T content-type Content-type header for POSTing        //POST数据所使用的Content-type头信息。
-v verbosity    How much troubleshooting info to print //设置显示信息的详细程度 - 4或更大值会显示头信息， 3或更大值可以显示响应代码(404, 200等), 2或更大值可以显示警告和其他信息。
-V 显示版本号并退出。
-w              Print out results in HTML tables       //以HTML表的格式输出结果。默认时，它是白色背景的两列宽度的一张表。
-i              Use HEAD instead of GET                // 执行HEAD请求，而不是GET
```



#### jmeter

jmeter能够对HTTP、webservice和FTP服务器进行压力和性能测试，也可以对任何数据库进行同样的测试(通过JDBC);支持可视化;输出格式丰富



jmeter依赖Java环境，安装jmeter之前先安装Java

```bash
下载安装包
#官网地址：http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html
#解压
tar -zxvf jdk-xxx.tar.gz  -C /path
chown -R root.root jdkxxx
ln -s jdkxxx java

#配置环境变量
vim /etc/profile
#在文件末尾添加一下内容：
#java环境变量添加
export JAVA_HOME=/path/to/file
export JRE_HOME=${JAVA_HOME}/jre
export PATH=${JAVA_HOME}/bin:$PATH

# 保存之后使修改的配置生效
source /etc/profile

#验证安装是否成功
java -version

# jdk升级：先下载新版本的jdk，解压完以后删除原先的软链接，重建软链接到新jdk上
```



jmeter安装

```bash
#下载安装包
wget https://dlcdn.apache.org//jmeter/binaries/apache-jmeter-xxx.tar.gz

#解压软件包
tar -zxvf apache-jmeter-xxx.tzr.gz
ln -s apache-jmeter-xxx jmeter

#配置环境变量
vim /etc/profile
#添加如下内容到profile文件最后
#jmeter环境变量设置
export JMETER=/opt/jmeter
export PATH=${JMETER}/bin:$PATH

#验证安装是否成功
jmeter -v
```



使用方法

```bash
jmeter -n -t [测试计划.jmx] -l [结果文件.jtl] -e -o [报告目录]
参数说明：
　　-h 帮助 -> 打印出有用的信息并退出
　　-n 非 GUI 模式 -> 在非 GUI 模式下运行 JMeter
　　-t 测试文件 -> 要运行的 JMeter 测试脚本文件
　　-l 日志文件 -> 记录结果的文件
　　-j 日志文件 -> JMeter运行日志路径
　　-r 远程执行 -> 启动远程服务
　　-R 指定远程执行的服务器 -> 指定要启动的远程服务器列表
　　-H 代理主机 -> 设置 JMeter 使用的代理主机
　　-P 代理端口 -> 设置 JMeter 使用的代理主机的端口号
　　-u 代理用户名 -> 设置 JMeter 使用的代理用户名
　　-a 代理密码 -> 设置 JMeter 使用的代理认证密码
```



#### wrk

wrk是一款针对http协议的基准测试工具，它能够在单机多核CPU的条件下，使用系统自带的高性能 I/O机制，如epoll,kqueue等，通过多线程和事件模式，对目标机器产生大量的负载。



安装依赖

```bash
# 安装编译依赖
yum install -y git gcc make openssl-devel

#安装LuaJIT(wrk依赖)
git clone https://luajit.org/git/luajit.git
cd LuaJIT-xxx
make && make install

# 验证安装
luajit -v
```



安装wrk

```bash
# 获取源码
git clone https://github.com/wg/wrk.git
cd wrk
make -j 2 #使用2C进行编译
./wrk -v #验证编译成功

#设置到系统路径
cp wrk /usr/local/bin/
chmod +x /usr/local/bin/wrk
wrk -v #验证安装
```



使用方法

```bash
wrk [options] <url>
选项说明：
    -t/--threads 指定使用的线程数，通常设置为 CPU 核心数
    -c/--connections 保持打开的 HTTP 连接数，低延迟服务：连接数 = 线程数 × 10~100；高延迟服务：连接数 = 线程数 × 100~1000
    -d/--duration 测试持续时间（可加后缀 s/m/h）
    -s/--script 指定 LuaJIT 脚本路径
    -H/--header 添加 HTTP 头（可多次使用）
    -L/--latency 打印详细的延迟统计	
    -R/--rate 设置请求/秒的目标速率
```



### 网卡压力测试

#### iperf/iperf3

基于TCP/IP和UDP/IP的网络性能测试工具，它可以用来测量网络带宽和网络质量，还可以提供网络延迟抖动、数据包丢失率、最大传输单元等统计信息。



安装

```
# wget http://downloads.es.net/pub/iperf/iperf-xxx.tar.gz
# tar zxvf iperf-xxx.tar.gz

# cd iperf-xxx
# ./configure
# make
# make install

yum -y install iperf3/apt-get install iperf3
```



使用方法

```
iperf [-s|-c host] [opts]  [args]
#服务器或客户端通用选项:
  -p, --port      #         服务器监听/连接的端口号
  -f, --format    [kmgKMG]  报告格式: Kbits, Mbits, KBytes, MBytes
  -i, --interval  #         定期带宽报告之间的时间间隔(秒)
  -F, --file name           传输/接收指定的文件
  -A, --affinity n/n,m      设置CPU亲和性
  -B, --bind      <host>    绑定到特定的网络接口
  -V, --verbose             更详细的输出
  -J, --json                以JSON格式输出
  --logfile f               将输出发送到日志文件
  --forceflush              强制在每个时间间隔刷新输出
  -d, --debug               输出调试信息
  -v, --version             显示版本信息并退出
  -h, --help                显示此帮助信息并退出

#服务器特定选项:
  -s, --server              以服务器模式运行
  -D, --daemon              将服务器作为守护进程运行
  -I, --pidfile file        写入PID文件
  -1, --one-off             处理一个客户端连接后退出

#客户端特定选项:
  -c, --client    <host>    以客户端模式运行，连接到<host>
  -u, --udp                 使用UDP而不是TCP
  -b, --bandwidth #[KMG][/#] 目标带宽(bits/sec)(0表示无限制)
                            (UDP默认为1 Mbit/sec，TCP无限制)
                            (可选的斜杠和数据包计数用于突发模式)
  --fq-rate #[KMG]          启用基于公平队列的套接字速率控制(bits/sec)(仅Linux)
  -t, --time      #         传输时间(秒)(默认10秒)
  -n, --bytes     #[KMG]    要传输的字节数(代替-t参数)
  -k, --blockcount #[KMG]   要传输的数据块(数据包)数量(代替-t或-n参数)
  -l, --len       #[KMG]    读写缓冲区的长度
                            (TCP默认128 KB，UDP为动态或1)
  --cport         <port>    绑定到特定的客户端端口(TCP和UDP，默认: 临时端口)
  -P, --parallel  #         要运行的并行客户端流数量
  -R, --reverse             以反向模式运行(服务器发送，客户端接收)
  -w, --window    #[KMG]    设置窗口大小/套接字缓冲区大小
  -C, --congestion <algo>   设置TCP拥塞控制算法(仅Linux和FreeBSD)
  -M, --set-mss   #         设置TCP/SCTP最大段大小(MTU - 40字节)
  -N, --no-delay            设置TCP/SCTP不延迟，禁用Nagle算法
  -4, --version4            仅使用IPv4
  -6, --version6            仅使用IPv6
  -S, --tos N               设置IP"服务类型"
  -L, --flowlabel N         设置IPv6流标签(仅Linux支持)
  -Z, --zerocopy            使用"零拷贝"方法发送数据
  -O, --omit N              忽略前n秒的数据
  -T, --title str           在每行输出前添加此字符串前缀
  --get-server-output       从服务器获取结果
  --udp-counters-64bit      在UDP测试数据包中使用64位计数器

[KMG] 表示该选项支持K/M/G后缀，分别代表千、兆、吉
```



常用命令

``` 
TCP/UDP带宽测试
server: iperf -s
client: iperf -c 192.168.1.100 [-u -b 100M]

[root@localhost ~]# iperf3 -s -V -p 8080 -i 5
[root@localhost ~]# iperf3 -c 10.50.1.209 -V -p 8080 -i 5 -l 64B -Z -t 300
```



#### qperf

用于测试TCP和UDP网络吞吐量、延迟等性能指标，可以测试网络中的服务器或客户端性能，支持多种协议和多种数据传输方式。

功能：

1.支持TCP、UDP、RDMA协议的测试。

2.支持多种数据传输方式的测试，如点对点、多点对点、一对多等。

3.支持测试吞吐量，延迟等性能指标。

4.支持同时测试多个客户端或服务器。



安装步骤：





#### netperf





## 三、查看系统信息

### 查看磁盘硬件信息

#### smartctl



## 四、文件管理

### 压缩

#### tar

```
#命令格式
tar [opts] [filename]

主要操作模式
-c	--create	创建新的归档文件
-x	--extract / --get	从归档中提取文件
-t	--list	列出归档内容
-d	--diff / --compare	比较归档与文件系统的差异
-r	--append	向归档末尾追加文件
-u	--update	仅追加比归档中版本新的文件
-A	--catenate / --concatenate	合并多个tar归档

文件选择和排除
-C, --directory=DIR	     在处理前切换到指定目录
--exclude=PATTERN	     排除匹配模式的文件
-T, --files-from=FILE	 从文件中读取要处理的文件列表
--wildcards	             在文件名中使用通配符(默认用于排除模式)
--recursion	             递归处理目录(默认)

压缩选项
-z, --gzip	             通过gzip压缩/解压
-j, --bzip2	             通过bzip2压缩/解压
-J, --xz	             通过xz压缩/解压
-a, --auto-compress	     根据文件后缀自动选择压缩程序
--zstd	                 通过zstd压缩/解压
-Z, --compress	         通过compress压缩/解压

归档处理和验证
-f, --file=ARCHIVE	    指定归档文件名(几乎总是需要)
-v, --verbose	        详细列出处理的文件
-W, --verify	        写入后验证归档
--checkpoint[=NUMBER]	每处理NUMBER个记录显示进度
-M, --multi-volume	    创建/列出/提取多卷归档
-k, --keep-old-files	提取时不覆盖现有文件

权限和属性处理
-p, --preserve-permissions	保留文件权限(超级用户默认)
--same-owner	保留文件所有者(超级用户默认)
--no-same-owner	以当前用户身份提取文件(普通用户默认)
--mtime=DATE	设置归档中文件的修改时间
--owner=NAME / --group=NAME	指定归档中文件的所有者/组
--acls / --xattrs / --selinux	保存ACL/扩展属性/SELinux上下文

高级功能
-g, --listed-incremental=FILE	处理GNU格式的增量备份
--delete	从归档中删除文件(不能用于磁带)
--transform=EXPRESSION	使用sed表达式转换文件名
--strip-components=NUMBER	提取时去除路径前NUMBER个组件
--one-top-level[=DIR]	创建子目录避免提取松散文件
--backup[=CONTROL]	在覆盖前备份文件
```

常用命令

```
1.创建tar存档文件
格式：tar -cf archive_name.tar file1 file2 file3 ...
tar -cf file.tar /etc  # 将/etc目录中的所有文件和子目录打包成一个名为file.tar的 tar 存档文件
tar -cvf file.tar /etc # 显示命令执行的详细信息
tar -cvzf file.tar.gz /etc /  tar -cjvf file.tar.bz2 /etc  /  tar -cJvf file.tar.xz /etc # 以gzip/bzip2/xz格式创建存档文件

2.解压tar存档文件
格式：tar -xf archive_name.tar 
tar -xf file.tar
tar -xvf file.tar -C /tmp
tar -xvzf file.tar.gz  /  tar -xjvf file.tar.bz2   /  tar -xJvf file.tar.xz 

3.列出存档文件内容
格式：tar -tvf archive_name.tar
tar -tvf file.tar
tar -tzvf file.tar.gz   /   tar -tjvf file.tar.bz2   /tar -tJvf file.tar.xz

4.高级用法
tar -cvf file.tar /path/to/files/* #压缩/path/to/files目录下的所有文件和子目录，并将存档文件保存为 file.tar。但是这种解压下来的格式将是path/to/files/*
想要解压下来只有文件必须在压缩的时候就进入到目录中，再进行压缩
cd /path
tar -cvf file.tar ./* 
或者是使用-P/--absolute-names选项指定绝对路径

创建增量备份：tar -czf file.tar.gz /path/to/files
tar -czf file.tar.gz --listed-incremental=/backup/incremental_backup.snar /path/to/files
#在下一次备份时，可以使用--listed-incremental选项指定增量备份文件（例如/backup/incremental_backup.snar），以便 tar 命令仅备份与上次备份之间的更改。

```



```
格式	压缩命令	解压命令
.tar	tar -cvf file.tar dir/	tar -xvf file.tar
.tar.gz	tar -czvf file.tar.gz dir/	tar -xzvf file.tar.gz
.tar.bz2	tar -cjvf file.tar.bz2 dir/	tar -xjvf file.tar.bz2
.tar.xz	tar -cJvf file.tar.xz dir/	tar -xJvf file.tar.xz
.zip	zip -r file.zip dir/	unzip file.zip
.rar	rar a file.rar dir/	rar x file.rar
.7z	7z a file.7z dir/	7z x file.7z
```



## 案例

### 端口占用解决完整流程

```bash
# 1. 查找占用端口的进程
lsof -i:8080
# 或
netstat -tulnlp | grep 8080

# 2. 终止进程（假设PID为1234）
kill -9 1234

# 3. 强制释放端口（如果kill后端口仍被占用）
fuser -k 8080/tcp

# 4. 验证端口是否释放
ss -tuln | grep 8080
```





### 系统资源瓶颈排查

#### CPU瓶颈

```bash
# 查看CPU使用率
top  # 按P排序
htop  # 更直观的CPU使用展示

# 查看每个CPU核心的使用情况
mpstat -P ALL 1

# 查看进程线程CPU占用
ps -Lp 1234 -o %cpu,pid,tid,comm  # 查看进程1234的线程CPU占用
```



#### 内存瓶颈

```bash
# 查看内存使用概况
free -h
vmstat 1

# 查看进程内存占用
top  # 按M排序
ps aux --sort=-%mem | head -10

# 查看内存泄漏嫌疑
valgrind --leak-check=full ./program  # C程序内存泄漏检测
jmap -histo:live 1234  # Java进程对象统计
```



#### 磁盘I/O瓶颈

```bash
# 查看磁盘I/O负载
iostat -x 1
iotop  # 按IO使用率排序进程

# 查看磁盘空间
# df -h 是最常见的磁盘查看命令。它可以显示文件系统的总大小、已用空间、可用空间和挂载点等信息。
df -h
# du命令是用于查看目录或文件占用磁盘空间的命令。
du -sh /var/* | sort -rh  # 按大小排序目录
# fdisk 命令可以显示系统中所有硬盘的分区情况，包括分区类型、容量、起始位置等信息。通过这个命令可以查看系统磁盘的物理结构和分布情况。
fdisk -l
# lsblk该命令可以列出系统中所有块设备（如硬盘、SSD 等）的信息，包括设备名称、容量、挂载点等。通过这个命令可以方便地了解系统硬件配置和磁盘分区情况。
lsblk

# 查找大文件
find / -type f -size +100M -exec du -h {} \;

# 磁盘健康检查
# smartctl命令是用于检测硬盘健康状态并显示相关信息的命令。它可以显示硬盘的温度、寿命预测、错误记录等信息。
yum/dnf search smartctl
# 由smartmontools包提供
smartctl -a /dev/磁盘名 #显示全部信息
```



### 网络问题排查

```bash
# 检查网络连接
netstat -an | grep ESTABLISHED  # 已建立连接
ss -ti  # TCP连接详情

# 抓包分析
tcpdump -i eth0 port 80 -w capture.pcap
tcpdump -r capture.pcap host 192.168.1.1

# 路由追踪
traceroute example.com
mtr example.com  # 结合ping和traceroute

# DNS排查
nslookup example.com
dig example.com
host example.com

```



### 日志分析技巧

```bash
# 实时跟踪日志
tail -f /var/log/application.log

# 查找错误日志
grep -i error /var/log/application.log
grep -iE "error|exception" /var/log/application.log

# 按时间范围过滤日志
sed -n '/2023-10-01 10:00:00/,/2023-10-01 11:00:00/p' /var/log/application.log

# 统计错误出现次数
grep -i error /var/log/application.log | wc -l

# 分析访问日志（按IP统计访问次数）
awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -nr | head -10
```

