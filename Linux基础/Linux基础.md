#  Linux基础

Linux构成：

内核态（内核空间）：使用底层硬件的，用于保护系统不能随意访问的程序

用户态（用户空间）：一系列的用户应用程序

## 一、常用命令

### ls

```bash
 ls [-alrtAFR] [name...]
选项
-a：显示所有文件及目录 (以**.**开头的隐藏文件也会列出)
-l：除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出
-r：将文件以相反次序显示(默认以英文字母次序)
-t：将文件依建立时间之先后次序列出
-A：同 -a ，但不列出 "." (目前目录) 及 ".." (父目录)
-F：在列出的文件名称后加一符号；例如可执行档则加 "*", 目录则加 "/"，链接加"@"
-R：若目录下有文件，则以下之文件亦皆依序列出
-h：将显示出来的文件大小以合适的单位显示出来
```



```bash
# 显示根目录下的文件信息
[root@localhost ~]# ls -ahl /
总用量 16K
dr-xr-xr-x.  17 root root  224 4月  27 10:28 .
dr-xr-xr-x.  17 root root  224 4月  27 10:28 ..
lrwxrwxrwx.   1 root root    7 4月  27 10:19 bin -> usr/bin
dr-xr-xr-x.   5 root root 4.0K 4月  27 10:32 boot
drwxr-xr-x.  20 root root 3.2K 4月  27 10:31 dev
drwxr-xr-x.  74 root root 8.0K 4月  27 11:16 etc
drwxr-xr-x.   3 root root   20 4月  27 11:16 home
lrwxrwxrwx.   1 root root    7 4月  27 10:19 lib -> usr/lib
lrwxrwxrwx.   1 root root    9 4月  27 10:19 lib64 -> usr/lib64
drwxr-xr-x.   2 root root    6 4月  11 2018 media
```

1. **第一列**共10位，第1位表示文档类型，`d`表示目录，`-`表示文件，`l`表示链接文件，`d`表示可随机存取的设备，如U盘等，`c`表示一次性读取设备，如鼠标、键盘等。后9位，依次对应三种身份所拥有的权限，身份顺序为：owner、group、others，权限顺序为：readable、writable、excutable。如：`-r-xr-x---`的含义为**当前文档是一个文件，拥有者可读、可执行，同一个群组下的用户，可读、可写，其他人没有任何权限**。
2. **第二列**表示链接数，表示有多少个文件链接到inode号码。
3. **第三列**表示拥有者
4. **第四列**表示所属群组
5. **第五列**表示文档容量大小，单位字节
6. **第六列**表示文档最后修改时间，注意不是文档的创建时间哦
7. **第七列**表示文档名称。以点(.)开头的是隐藏文档



### cd

用于切换当前工作目录

```bash
cd [dirName]
cd ~ 进入的是自己的homemu'k
```



### pwd

显示工作目录

```bash
pwd [-LP]
```

- -L 打印 $PWD 变量的值，如果它命名了当前的工作目录
- -P 打印当前的物理路径，不带有任何的符号链接

默认情况下，`pwd`的行为和带`-L`选项一致



### clear

用于清除屏幕

```bash
clear #同crtl+L
```



### echo

用于字符串的输出

```bash
echo [-neE] 字符串
选项
-n：不输出行尾的换行符
-e：允许对下面列出的加反斜线转义的字符进行解释
     \ 反斜线
     \a 报警符(BEL)
     \b 退格符
     \c 禁止尾随的换行符
     \f 换页符
     \n 换行符
     \r 回车符
     \t 水平制表符
     \v 纵向制表符
 -E 禁止对在STRINGs中的那些序列进行解释
```



### 修改机主名

1.使用 hostnamectl 命令

```shell
hostnamectl set-hostname your-new-hostname   #将your-new-hostname替换为想要设置的新主机名。
systemctl restart network
```

2.编辑 `/etc/hostname` 文件

```shell
echo your-new-hostname > /etc/hostname  #或者使用文本编辑器手动编辑/etc/hostname文件，并将里面的内容替换为新主机名。
systemctl restart network
```



### 修改完配置刷新

source filename / ` . filename `

systemctl restart xxxx

bash(启动新的bash进程，替换现在进程)

重启系统：reboot，poweroff，shutdown



查看命令类型

type 

```bash
type [选项] 命令
    选项：
     -a：显示所有与给定命令相关的位置。
     -t：仅显示给定命令的类型。
     -P：查找给定命令的完整路径。
```



## 二、系统命令

### poweroff

用于关闭计算器并切断电源

```bash
poweroff [-n] [-w] [-d] [-f] [-i] [-h]
```

#### 选项

- **-n**: 在关机前不做将记忆体资料写回硬盘的动作
- **-w**: 并不会真的关机，只是把记录写到 /var/log/wtmp 档案里
- **-d**: 不把记录写到 /var/log/wtmp 文件里
- **-i**: 在关机之前先把所有网络相关的装置先停止
- **-p**: 关闭操作系统之前将系统中所有的硬件设置为备用模式。



### reboot

用来重新启动计算机

```bash
reboot [-n] [-w] [-d] [-f] [-i]
```

选项

- **-n**: 在重开机前不做将记忆体资料写回硬盘的动作
- **-w**: 并不会真的重开机，只是把记录写到 /var/log/wtmp 档案里
- **-d**: 不把记录写到 /var/log/wtmp 档案里（-n 这个参数包含了 -d）
- **-f**: 强迫重开机，不呼叫 shutdown 这个指令
- **-i**: 在重开机之前先把所有网络相关的装置先停止



### whoami 

用于显示自身用户名称

```bash
[root@localhost ~]# whoami
root
```



### 修改环境语言

```bash
[root@localhost ~]# yum install -y langpacks-zh_CN        # 安装中文包支持
[root@localhost ~]# export LANG=zh_CN.UTF-8
# 改回中文是LANG=en_US.UTF-8
```



### 重设用户密码

centos7：重启进GRUB界面，选中“CentOS Linux (内核版本) 7 (Core)，然后按"e"。进入编辑模式找到“ro crashkernel”，然后将ro更改为rw init=/sysroot/bin/sh。修改完以后，按crtl+x进入单用户模式，执行命令chroot /sysroot访问系统，输入passwd root修改root用户密码，输入你的新密码，出现successfully时说明重置密码成功。更新系统信息，touch /.autorelabel，执行命令touch /.autorelabel，在/目录下创建一个.autorelabel文件，如果该文件存在，系统在重启时就会对整个文件系统进行relabeling重新标记 。然后exit，reboot后即可登录。

Rocky9：重启进GRUB界面，选择Rocky Linux (内核版本) 9.x，按"e"。进入编辑模式，将ro改为 rw init=/sysroot/bin/sh ，修改之后，按ctrl-x退出。输入chroot/sysroot，输入passwd root回车，输入两次同样的密码。**（如果没有设置selinux不用设置）如果开启了SELinux，最后一步最为关键设置SElinux重启标记，命令如下，不执行依然登录不了系统。**touch /.autorelabel。然后exit，reboot后即可登录。

RHEL9：重启进GRUB界面，将光标移动到要启动修复的内核，按"e"。进入编辑模式，将光标移至以linux开头的行，此为内核命令行，将内核命令行末尾删除参数一直删除到ro后添加rd.break，按ctrl+x继续启动，重启以读写方式挂载/sysroot   mount -o remount,rw /sysroot，切换至真正操作系统的根/sysroot  chroot /sysroot 重置密码，打标签 touch /.autorelabel，exit退出两次



## 三、快捷键

| 快捷键 | 作用                     |
| :----- | ------------------------ |
| ^C     | 终止前台运行的程序       |
| ^D     | 退出 等价exit            |
| ^L     | 清屏                     |
| ^A     | 光标移动到命令行的最前端 |
| ^E     | 光标移动到命令行的后端   |
| ^U     | 删除光标前所有字符       |
| ^K     | 删除光标后所有字符       |
| ^R     | 搜索历史命令，利用关键词 |
| ^Z     | 进程挂起                 |
| ^W     | 单个单词回退删除         |
| ^F     | 后移                     |
| ^B     | 前移                     |



## 四、帮助命令

### history

```bash
history [n]  #n为数字，列出最近的n条命令
```

选项

- **-c**：将目前shell中的所有history命令消除
- **-a**：将目前新增的命令写入histfiles, 默认写入`~/.bash_history`
- **-r**：将histfiles内容读入到目前shell的history记忆中
- **-w**：将目前history记忆的内容写入到histfiles

- 使用`!`执行历史命令。
- `! number`执行第几条命令
- `! command`从最近的命令查到以`command`开头的命令执行
- `!!`执行上一条



### help

显示命令的帮助信息

```bash
help [-dms] [内置命令]
```

选项

- **-d**：输出每个主题的简短描述
- **-m**：以伪 man 手册的格式显示使用方法
- -s：为每一个匹配 PATTERN 模式的主题仅显示一个用法



### man

显示在线帮助手册页

```bash
man 需要帮助的命令或者文件 
```

快捷键

| 按键      | 用途                               |
| :-------- | :--------------------------------- |
| 空格键    | 向下翻一页                         |
| PaGe down | 向下翻一页                         |
| PaGe up   | 向上翻一页                         |
| home      | 直接前往首页                       |
| end       | 直接前往尾页                       |
| /         | 从上至下搜索某个关键词，如“/linux” |
| ?         | 从下至上搜索某个关键词，如“?linux” |
| n         | 定位到下一个搜索到的关键词         |
| N         | 定位到上一个搜索到的关键词         |
| q         | 退出帮助文档                       |



### alias

用于设置指令的别名

实例

- 查看系统当前的别名

```bash
[root@localhost ~]# alias   # 查看系统当前的别名
```

- 修改别名，比如使用wl来查看IP地址相关信息

```bash
[root@localhost ~]# alias wl='ip address'
[root@localhost ~]# wl
```

- 为了让别名永久生效，可以讲修改别名的命令写入`bashrc`文件，这个文件中的命令会在每次登陆命令行的时候执行

```bash
[root@localhost ~]# echo "alias wl='ip address'" >> /etc/bashrc
```



## 五、文件管理

### touch（创建新文件）

用于修改文件或者目录的时间属性，包括存取时间和更改时间。若文件不存在，系统会建立一个新的文件。

```bash
touch 文件名
```



### mkdir (创建新目录)

创建新的目录的

```bash
mkdir [-mpv] 目录名称
```

选项

- **-m**：配置文件的权限！直接配置，采用八进制显示，属主属组和others各占一位，不需要看默认权限 (umask)
- **-p**：帮助你直接将所需要的目录(包含上一级目录)递归创建起来！
- **-v**:显示目录创建的过程



### rmdir（删除空目录）

```shell
rmdir 目录名称
```



### cp (复制文件或目录)

复制文件和目录

```bash
cp [选项]... 源文件... 目录
```

选项

- **-a：**相当於 -pdr 的意思，即递归完全复制文件的属性；**(常用)**
- **-d：**若来源档为连结档的属性(link file)，则复制连结档属性而非文件本身；
- **-f：**为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；
- **-i：**若目标档(destination)已经存在时，在覆盖时会先询问动作的进行**(常用)**
- **-l：**进行硬式连结(hard link)的连结档创建，而非复制文件本身；
- **-p：**连同文件的属性一起复制过去，而非使用默认属性(备份常用)；
- **-r：**递归持续复制，用于目录的复制行为；**(常用)**
- **-s：**复制成为符号连结档 (symbolic link)，亦即『捷径』文件；
- **-u：**若 destination 比 source 旧才升级 destination ！
- **-v：**显示复制的详细过程



### mv(移动文件与目录，或修改名称)

移动文件与目录，或修改名称

```bash
mv [选项]... 源文件... 目录
```

选项

- **-f**：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖；
- **-i**：若目标文件已经存在时，就会询问是否覆盖！
- **-u**：若目标文件已经存在，且 source 比较新，才会升级
- **-v：**显示复制的详细过程



### rm (移除文件或目录)

移除文件或目录

```bash
rm [选项]... 文件...
```

选项

- **-f**：就是 force 的意思，强制删除，忽略不存在的文件，不会出现警告信息；
- **-i**：互动模式，在删除前会询问使用者是否删除
- **-r**：递归删除，最常用在目录的删除（这是非常危险的选项！！！）



### cat

用于打开文本文件并显示出来

```bash
cat [选项]... [文件]...
```

选项

- **-n**：由 1 开始对所有输出的行数编号
- **-b**：和 -n 相似，只不过对于空白行不编号。
- **-s**：当遇到有连续两行以上的空白行，就代换为一行的空白行。
- **-A**：显示控制字符。



### less

可以随意浏览文件，支持翻页和搜索，支持向上翻页和向下翻页

```bash
less [文件名]
```



### head

查看文件的开头部分的内容

```bash
head [选项]... [文件]...
```

参数

- **-q**：隐藏文件名，默认是隐藏
- **-v**：显示文件名
- **-c<数目>**：显示的字节数。
- **-n<行数>**：显示的行数。



### tail

会把文本文件里的最尾部的内容显示在屏幕上

```bash
tail [选项]... [文件]...
```

参数

- **-f**：循环读取
- **-q**：隐藏文件名，默认隐藏
- **-v**：显示文件名
- **-c<数目>**：显示的字节数
- **-n<行数>**：显示文件的尾部 n 行内容
- **-s**：与-f合用,表示在每次反复的间隔休眠S秒



### 文本文件编辑

以下是常用的几个命令：

**“i”**切换到输入模式，以输入字符。

**“x”**删除当前光标所在处的字符。

**“:”**切换到末行模式，以在最底一行输入命令。



#### 输入模式

在命令模式下按下`i`就进入了输入模式。

在输入模式中，可以使用以下按键：

- **字符按键以及Shift组合**，输入字符
- **ENTER**，回车键，换行
- **BACK SPACE**，退格键，删除光标前一个字符
- **DEL**，删除键，删除光标后一个字符
- **方向键**，在文本中移动光标
- **HOME**/**END**，移动光标到行首/行尾
- **Page Up**/**Page Down**，上/下翻页
- **Insert**，切换光标为输入/替换模式，光标将变成竖线/下划线
- **ESC**，退出输入模式，切换到命令模式



#### 末行模式

在命令模式下按下`:`（英文冒号）就进入了末行模式。

末行模式可以输入单个或多个字符的命令，可用的命令非常多。

在末行模式中，基本的命令有：

**:q**退出程序

**:w**保存文件

按ESC键可随时退出末行模式。



#### vi/vim按键说明

除了上面简易范例的 i, Esc, :wq 之外，其实 vim 还有非常多的按键可以使用。

下面将会列举出vim非常多的常用按键，初学者只需要浏览一遍，记住大概vim有哪些功能，等后面大量使用vim的时候，再来翻阅笔记，并且在多次使用中把这些功能记住。



##### 命令模式（下面的操作都是在命令模式下进行的）

**移动光标的方法**

| h 或 向左箭头键(←) | 光标向左移动一个字符                                         |
| :----------------- | :----------------------------------------------------------- |
| j 或 向下箭头键(↓) | 光标向下移动一个字符                                         |
| k 或 向上箭头键(↑) | 光标向上移动一个字符                                         |
| l 或 向右箭头键(→) | 光标向右移动一个字符                                         |
| [Ctrl] + [f]       | 屏幕『向下』移动一页，相当于 [Page Down]按键 (常用)          |
| [Ctrl] + [b]       | 屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)           |
| [Ctrl] + [d]       | 屏幕『向下』移动半页                                         |
| [Ctrl] + [u]       | 屏幕『向上』移动半页                                         |
| +                  | 光标移动到非空格符的下一行                                   |
| -                  | 光标移动到非空格符的上一行                                   |
| n                  | 那个 n 表示『数字』，例如 20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20 则光标会向后面移动 20 个字符距离。 |
| 0 或功能键[Home]   | 这是数字『 0 』：移动到这一行的最前面字符处 (常用)           |
| $ 或功能键[End]    | 移动到这一行的最后面字符处(常用)                             |
| H                  | 光标移动到这个屏幕的最上方那一行的第一个字符                 |
| M                  | 光标移动到这个屏幕的中央那一行的第一个字符                   |
| L                  | 光标移动到这个屏幕的最下方那一行的第一个字符                 |
| G                  | 移动到这个档案的最后一行(常用)                               |
| nG                 | n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行(可配合 :set nu) |
| gg                 | 移动到这个档案的第一行，相当于 1G  (常用)                    |
| n                  | n 为数字。光标向下移动 n 行(常用)                            |



##### **文本的搜索与替换**

| /word                                      | 向光标之下寻找一个名称为 word 的字符串。 (常用)              |
| :----------------------------------------- | :----------------------------------------------------------- |
| ?word                                      | 向光标之上寻找一个字符串名称为 word 的字符串。               |
| n                                          | 这个 n 是英文按键。代表重复前一个搜寻的动作。                |
| N                                          | 这个 N 是英文按键。与 n 刚好相反，为『反向』进行前一个搜寻动作。 |
| :n1,n2s/word1/word2/g                      | n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 (常用) |
| :1,$s/word1/word2/g 或 :%s/word1/word2/g   | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！(常用) |
| :1,$s/word1/word2/gc 或 :%s/word1/word2/gc | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代！(常用) |



##### **删除/剪切、复制与粘贴**

| x, X     | 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字符(相当于 [backspace] 亦即是退格键) (常用) |
| :------- | :----------------------------------------------------------- |
| nx       | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符10x |
| dd       | 删除/剪切光标所在的那一整行(常用)                            |
| ndd      | n 为数字。删除/剪切光标所在的向下 n 行，例如 20dd 则是删除 20 行 (常用) |
| d1G      | 删除光标所在到第一行的所有数据                               |
| dG       | 删除光标所在到最后一行的所有数据                             |
| d$       | 删除游标所在处，到该行的最后一个字符                         |
| d0       | 那个是数字的 0 ，删除光标所在处，到该行的最前面一个字符      |
| yy       | 复制游标所在的那一行(常用)                                   |
| nyy      | n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行(常用) |
| y1G      | 复制游标所在行到第一行的所有数据                             |
| yG       | 复制游标所在行到最后一行的所有数据                           |
| y0       | 复制光标所在的那个字符到该行行首的所有数据                   |
| y$       | 复制光标所在的那个字符到该行行尾的所有数据                   |
| p, P     | p 为将已复制的数据在光标下一行贴上，P 则为贴在光标上一行！ 举例来说，我目前光标在第 20 行，且已经复制了 10 行数据。则按下 p 后， 那 10 行数据会贴在原本的 20 行之后，亦即由 21 行开始贴。但如果是按下 P 呢？ 那么原本的第 20 行会被推到变成 30 行。 (常用) |
| J        | 将光标所在行与下一行的数据结合成同一行                       |
| c        | 重复删除多个数据，例如向下删除 10 行，[ 10c ]                |
| u        | 复原前一个动作。(常用)                                       |
| [Ctrl]+r | 重做上一个动作。(常用)                                       |
| .        | 重复前一个动作。 如果你想要重复删除、重复贴上等等动作，按下小数点『.』就好了！ (常用) |

全部删除快捷方式:gg+dG或G+d1G



##### **进入输入或取代的编辑模式**

| i, I  | 进入输入模式(Insert mode)： i 为『从目前光标所在处输入』， I 为『在目前所在行的第一个非空格符处开始输入』。 (常用) |
| :---- | :----------------------------------------------------------- |
| a, A  | 进入输入模式(Insert mode)： a 为『从目前光标所在的下一个字符处开始输入』， A 为『从光标所在行的最后一个字符处开始输入』。(常用) |
| o, O  | 进入输入模式(Insert mode)： 这是英文字母 o 的大小写。o 为在目前光标所在的下一行处输入新的一行； O 为在目前光标所在的上一行处输入新的一行！(常用) |
| r, R  | 进入取代模式(Replace mode)： r 只会取代光标所在的那一个字符一次；R会一直取代光标所在的文字，直到按下 ESC 为止；(常用) |
| [Esc] | 退出编辑模式，回到一般模式中(常用)                           |



##### **末行模式下的储存、离开等指令**

| :w                  | 将编辑的数据写入硬盘中(常用)                                 |
| :------------------ | :----------------------------------------------------------- |
| :w!                 | 若文件属性为『只读』时，强制写入该文件。不过，到底能不能写入， 还是跟你对该文件的权限有关 |
| :q                  | 离开 vi (常用)                                               |
| :q!                 | 若曾修改过文件，又不想储存，使用 ! 为强制离开不储存。        |
| :wq                 | 储存后离开，若为 :wq! 则为强制储存后离开 (常用)              |
| ZZ                  | 这是大写的 Z 喔！如果修改过，保存当前文件，然后退出！效果等同于   `保存并退出` |
| :x                  | 效果等同于  `保存并退出`                                     |
| :X                  | 大写的X，用于加密文件                                        |
| ZQ                  | 不保存，强制退出。效果等同于**:q!**。                        |
| :w [filename]       | 将编辑的数据储存成另一个文件（类似文件另存为）               |
| :r [filename]       | 在编辑的数据中，读入另一个文件的数据。亦即将 『filename』 这个文件内容加到光标所在行后面 |
| :n1,n2 w [filename] | 将 n1 到 n2 的内容储存成 filename 这个文件。                 |
| :! command          | 暂时离开 vi 到bash命令行下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的文件信息！ |



##### **vim环境变量修改**

| :set nu     | 显示行号，设定之后，会在每一行的前缀显示该行的行号 |
| :---------- | :------------------------------------------------- |
| :set nonu   | 与 set nu 相反，为取消行号！                       |
| :set ts=num | 设置TAB键的格数                                    |

